package com.intel.mountwilson.util.vmware;


import com.intel.mtwilson.agent.vmware.VMwareClient;
import com.intel.mtwilson.datatypes.TxtHostRecord;
import java.util.List;
import org.junit.Test;

//import sun.misc.BASE64Encoder;
//import sun.misc.BASE64Decoder;
/**
 * These tests verify that the data model serializes and de-serializes properly.
 * 
 * Commented out the Base64 tests because:
 * 1) they passed, commons-encoder output is identical to the Sun encoder
 * 2) the Sun encoder is a private API, and on some JVM's it's not available to programs
 * 
 * When you use the commons encoder, be aware that:
 * Base64.encodeBase64String returns output with newlines to fit into 76 character wide space
 * So to get a "pure" string you need to do new String(Base64.encodeBase64(some bytes));
 *
 * @author jbuhacoff
 */
public class VMwareClientTest {

    /**
     * Sample response from vcenter:
     * <?xml version="1.0" ?><Host_Attestation_Report Host_Name="10.1.71.174" vCenterVersion="5.1.0" HostVersion="5.1.0" TXT_Support="true"><EventDetails EventName="Vim25Api.HostTpmCommandEventDetails" ComponentName="" DigestValue="322431F52AEDF88B9487C882DB842B5F91934F2A" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="True" HostName="10.1.71.174"></EventDetails><EventDetails EventName="Vim25Api.HostTpmOptionEventDetails" ComponentName="useropts.gz" DigestValue="DA39A3EE5E6B4B0D3255BFEF95601890AFD80709" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="chardevs.b00" DigestValue="10968F914FABFF70E6C13F137D3A3FAA97F5B5BC" ExtendedToPCR="19" PackageName="esx-base" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="user.b00" DigestValue="E779F0AE549EDBA253345C843F6413B3F9B14513" ExtendedToPCR="19" PackageName="esx-base" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="s.v00" DigestValue="E5F6972D600A94D53F3F8F3C46C47F44D176BC59" ExtendedToPCR="19" PackageName="esx-base" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v00" DigestValue="422843D92AE5F2C28366E2A1F98502B3579E6729" ExtendedToPCR="19" PackageName="ata-pata-amd" PackageVendor="VMware" PackageVersion="0.3.10-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v01" DigestValue="4C22F3AE4E1462C50520B18A1E2CFCC9AAAA48FE" ExtendedToPCR="19" PackageName="ata-pata-atiixp" PackageVendor="VMware" PackageVersion="0.4.6-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v02" DigestValue="FD50FA7A910E6A211D8D628E369898FDE2DB9869" ExtendedToPCR="19" PackageName="ata-pata-cmd64x" PackageVendor="VMware" PackageVersion="0.2.5-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v03" DigestValue="9C590A3EAC47386C8E2B8D1B4061CAEB3897CD87" ExtendedToPCR="19" PackageName="ata-pata-hpt3x2n" PackageVendor="VMware" PackageVersion="0.3.4-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v04" DigestValue="11EA7255E06C4CD8E3675F2A9463179F954752DF" ExtendedToPCR="19" PackageName="ata-pata-pdc2027x" PackageVendor="VMware" PackageVersion="1.0-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v05" DigestValue="F72C69C57D50E23668927B3F2776238854AE6E11" ExtendedToPCR="19" PackageName="ata-pata-serverworks" PackageVendor="VMware" PackageVersion="0.4.3-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v06" DigestValue="FB0FF8F9D955C2EB1E0A5EFAAF160BA2E520DCC2" ExtendedToPCR="19" PackageName="ata-pata-sil680" PackageVendor="VMware" PackageVersion="0.4.8-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ata_pata.v07" DigestValue="505F86E9A0F809AC7EC6E5C2BAD9B37090C21EA0" ExtendedToPCR="19" PackageName="ata-pata-via" PackageVendor="VMware" PackageVersion="0.3.3-2vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="block_cc.v00" DigestValue="C9AAEEBD0CCC5A3CEE5E580AEC5D33BC4F7F2A5C" ExtendedToPCR="19" PackageName="block-cciss" PackageVendor="VMware" PackageVersion="3.6.14-10vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ehci_ehc.v00" DigestValue="92E06806B5BD33DC7474E15632310D985DE492F6" ExtendedToPCR="19" PackageName="ehci-ehci-hcd" PackageVendor="VMware" PackageVersion="1.0-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="weaselin.t00" DigestValue="9008E09C6064610C752044EF9A805569F7066707" ExtendedToPCR="19" PackageName="esx-base" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="esx_dvfi.v00" DigestValue="16F0B08444ABBD615E7B6E7511C0AF002DB21BDB" ExtendedToPCR="19" PackageName="esx-dvfilter-generic-fastpath" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="xlibs.v00" DigestValue="8AC75D53D106F0548F9B555296340AF13B47806E" ExtendedToPCR="19" PackageName="esx-xlibs" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ima_qla4.v00" DigestValue="80A0E25BB8FFC1E653272ED7A0D414C37D2F64A8" ExtendedToPCR="19" PackageName="ima-qla4xxx" PackageVendor="VMware" PackageVersion="2.01.31-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ipmi_ipm.v00" DigestValue="73707C0732D5D7811B613B322B1D09981BF680F4" ExtendedToPCR="19" PackageName="ipmi-ipmi-devintf" PackageVendor="VMware" PackageVersion="39.1-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ipmi_ipm.v01" DigestValue="3B4FA513658D9B0CC095F3E349E43D9664911255" ExtendedToPCR="19" PackageName="ipmi-ipmi-msghandler" PackageVendor="VMware" PackageVersion="39.1-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ipmi_ipm.v02" DigestValue="E32F6CA4A041391633BD03E145C5705C6C437527" ExtendedToPCR="19" PackageName="ipmi-ipmi-si-drv" PackageVendor="VMware" PackageVersion="39.1-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="misc_cni.v00" DigestValue="DA89A08E356BA50C5A7291FBF6D08F802807862B" ExtendedToPCR="19" PackageName="misc-cnic-register" PackageVendor="VMware" PackageVersion="1.1-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="misc_dri.v00" DigestValue="3BD63BAE4C5015A1A6045FE365D715C5B23904A0" ExtendedToPCR="19" PackageName="misc-drivers" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_be2n.v00" DigestValue="DB2FC4626C576FFBC75265B2A35EBBB5DE2A9177" ExtendedToPCR="19" PackageName="net-be2net" PackageVendor="VMware" PackageVersion="4.1.255.11-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_bnx2.v00" DigestValue="AC2D3417E3FDCBDF51D7FA16DB025D458B2470B0" ExtendedToPCR="19" PackageName="net-bnx2" PackageVendor="VMware" PackageVersion="2.0.15g.v50.11-7vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_bnx2.v01" DigestValue="AFB4C25F9C85C559F387B78BB59712CB51F3626A" ExtendedToPCR="19" PackageName="net-bnx2x" PackageVendor="VMware" PackageVersion="1.61.15.v50.3-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_cnic.v00" DigestValue="B45D118130287AF6FD2CFEF08B388B48B48368EB" ExtendedToPCR="19" PackageName="net-cnic" PackageVendor="VMware" PackageVersion="1.10.2j.v50.7-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_e100.v00" DigestValue="085C04123040710B5C029D93CCF8C646AAF68B7D" ExtendedToPCR="19" PackageName="net-e1000" PackageVendor="VMware" PackageVersion="8.0.3.1-2vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_e100.v01" DigestValue="8A977A1F8F630F2C815977910A67E3E7FAC2CFCD" ExtendedToPCR="19" PackageName="net-e1000e" PackageVendor="VMware" PackageVersion="1.1.2-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_enic.v00" DigestValue="1E1348F87F4D84C49CA0139E68BB76AD1496A132" ExtendedToPCR="19" PackageName="net-enic" PackageVendor="VMware" PackageVersion="1.4.2.15a-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_forc.v00" DigestValue="5127E8BDC9230B5F8F11D19AA7CE8090A2943657" ExtendedToPCR="19" PackageName="net-forcedeth" PackageVendor="VMware" PackageVersion="0.61-2vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_igb.v00" DigestValue="A2836F0E1F5C4C53CB4954AD73AA8DF2E778B495" ExtendedToPCR="19" PackageName="net-igb" PackageVendor="VMware" PackageVersion="2.1.11.1-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_ixgb.v00" DigestValue="9536A8E2DAB398B893D33434924DDDC81D8D1E37" ExtendedToPCR="19" PackageName="net-ixgbe" PackageVendor="VMware" PackageVersion="3.7.13.6iov-10vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_nx_n.v00" DigestValue="B4D0F6479D43D92AC58299A6B5ADDDB6BB5E9704" ExtendedToPCR="19" PackageName="net-nx-nic" PackageVendor="VMware" PackageVersion="4.0.558-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_r816.v00" DigestValue="56915E9AD6316912B05A90659148BAEE15EEF639" ExtendedToPCR="19" PackageName="net-r8168" PackageVendor="VMware" PackageVersion="8.013.00-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_r816.v01" DigestValue="AA2F9CE8525CFBC293F71CBBEBE170C6B9BDC3F3" ExtendedToPCR="19" PackageName="net-r8169" PackageVendor="VMware" PackageVersion="6.011.00-2vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_s2io.v00" DigestValue="13C5C7BAC64D5C10C4A001BF58419FAA4ADA75C7" ExtendedToPCR="19" PackageName="net-s2io" PackageVendor="VMware" PackageVersion="2.1.4.13427-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_sky2.v00" DigestValue="CFF86D954BD74BEDCDBEF734621B367DB0273978" ExtendedToPCR="19" PackageName="net-sky2" PackageVendor="VMware" PackageVersion="1.20-2vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_tg3.v00" DigestValue="6ACCBC31A0301A2C50424C243762507525FC7D22" ExtendedToPCR="19" PackageName="net-tg3" PackageVendor="VMware" PackageVersion="3.110h.v50.4-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="net_vmxn.v00" DigestValue="BA3CF20D2F2742CA01BE2FFEA7CF6E1A9AFECF9C" ExtendedToPCR="19" PackageName="net-vmxnet3" PackageVendor="VMware" PackageVersion="1.1.3.0-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="ohci_usb.v00" DigestValue="833E75A882025671EAEFC9293BB1B76B84A97A10" ExtendedToPCR="19" PackageName="ohci-usb-ohci" PackageVendor="VMware" PackageVersion="1.0-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_ahc.v00" DigestValue="C6912754C3D0EE991B08BEDBB622339B4CAB040C" ExtendedToPCR="19" PackageName="sata-ahci" PackageVendor="VMware" PackageVersion="3.0-13vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_ata.v00" DigestValue="0654EB16F793714D8DD126E3C36B03D0E92E6FBE" ExtendedToPCR="19" PackageName="sata-ata-piix" PackageVendor="VMware" PackageVersion="2.12-6vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_sat.v00" DigestValue="2FEAF8A6E60B6C3607F797ECB7D29E4738B52A94" ExtendedToPCR="19" PackageName="sata-sata-nv" PackageVendor="VMware" PackageVersion="3.5-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_sat.v01" DigestValue="7D365735235ECBFF49CCB7EC778AD96472546253" ExtendedToPCR="19" PackageName="sata-sata-promise" PackageVendor="VMware" PackageVersion="2.12-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_sat.v02" DigestValue="8DF911BEABB68C3CE90B46F3B7B32F4393864F6A" ExtendedToPCR="19" PackageName="sata-sata-sil24" PackageVendor="VMware" PackageVersion="1.1-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_sat.v03" DigestValue="13DF4913102787712B686FB5BF99E76D714D2490" ExtendedToPCR="19" PackageName="sata-sata-sil" PackageVendor="VMware" PackageVersion="2.3-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="sata_sat.v04" DigestValue="C1F8B674B813F2179B59C27B75848713755DE9BB" ExtendedToPCR="19" PackageName="sata-sata-svw" PackageVendor="VMware" PackageVersion="2.3-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_aac.v00" DigestValue="C599FB012A454E5260A283488640B013581AD614" ExtendedToPCR="19" PackageName="scsi-aacraid" PackageVendor="VMware" PackageVersion="1.1.5.1-9vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_adp.v00" DigestValue="0ECE3C399C5A1DC32F0506836BB6DFEB89C68D9D" ExtendedToPCR="19" PackageName="scsi-adp94xx" PackageVendor="VMware" PackageVersion="1.0.8.12-6vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_aic.v00" DigestValue="792BCAE85B9F3252AA8165165B089E44157F36C0" ExtendedToPCR="19" PackageName="scsi-aic79xx" PackageVendor="VMware" PackageVersion="3.1-5vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_bnx.v00" DigestValue="A996DEA4F36E065E8FC789799858BAE6A97FBD6F" ExtendedToPCR="19" PackageName="scsi-bnx2i" PackageVendor="VMware" PackageVersion="1.9.1d.v50.1-5vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_fni.v00" DigestValue="4BAA9AAAD5061DF4C7F5575D543BE55F83F8E266" ExtendedToPCR="19" PackageName="scsi-fnic" PackageVendor="VMware" PackageVersion="1.5.0.3-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_hps.v00" DigestValue="52AD0E34EEA6FB21F29601EF788FAB031CB052EF" ExtendedToPCR="19" PackageName="scsi-hpsa" PackageVendor="VMware" PackageVersion="5.0.0-21vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_ips.v00" DigestValue="84AE8415BF9E4640314AADB027514FE19F0025E3" ExtendedToPCR="19" PackageName="scsi-ips" PackageVendor="VMware" PackageVersion="7.12.05-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_lpf.v00" DigestValue="25BB83D66B095C02966481D59217815CF94873E9" ExtendedToPCR="19" PackageName="scsi-lpfc820" PackageVendor="VMware" PackageVersion="8.2.3.1-127vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_meg.v00" DigestValue="FDB50A4AC13AA323AB421A1D71EA5302E2C2FE99" ExtendedToPCR="19" PackageName="scsi-megaraid-mbox" PackageVendor="VMware" PackageVersion="2.20.5.1-6vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_meg.v01" DigestValue="444C4ABC97F48EC914F4C8388AAF3BD65947DA15" ExtendedToPCR="19" PackageName="scsi-megaraid-sas" PackageVendor="VMware" PackageVersion="5.34-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_meg.v02" DigestValue="07D63C411BA0573298E0C5FF822B23B9DDAE3FB5" ExtendedToPCR="19" PackageName="scsi-megaraid2" PackageVendor="VMware" PackageVersion="2.00.4-9vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_mpt.v00" DigestValue="67E5D8494A9582BFF55BCD91BA3E8ED244FD9755" ExtendedToPCR="19" PackageName="scsi-mpt2sas" PackageVendor="VMware" PackageVersion="10.00.00.00-5vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_mpt.v01" DigestValue="5740BCAB16F471D4C0C4B7C871A28ACE1C8697A2" ExtendedToPCR="19" PackageName="scsi-mptsas" PackageVendor="VMware" PackageVersion="4.23.01.00-6vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_mpt.v02" DigestValue="34ABC2F21F19FBEB799CDBFF38D373119B8FCA7B" ExtendedToPCR="19" PackageName="scsi-mptspi" PackageVendor="VMware" PackageVersion="4.23.01.00-6vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_qla.v00" DigestValue="F854069871E068F762D0D48B1DA1D854FCD3C925" ExtendedToPCR="19" PackageName="scsi-qla2xxx" PackageVendor="VMware" PackageVersion="902.k1.1-9vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_qla.v01" DigestValue="F0EFC2C42652176375B0F356825CC355C1021C3F" ExtendedToPCR="19" PackageName="scsi-qla4xxx" PackageVendor="VMware" PackageVersion="5.01.03.2-4vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="scsi_rst.v00" DigestValue="D6DD7EA297BBE89B0792E5A70E2A8E7931502F1E" ExtendedToPCR="19" PackageName="scsi-rste" PackageVendor="VMware" PackageVersion="2.0.2.0088-1vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="uhci_usb.v00" DigestValue="C7BB26D054BF70D30446CB4E3A3717107BA9898E" ExtendedToPCR="19" PackageName="uhci-usb-uhci" PackageVendor="VMware" PackageVersion="1.0-3vmw.510.0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="xorg.v00" DigestValue="CBE879E9D9F4473E9F201A884450F51BC80B0980" ExtendedToPCR="19" PackageName="esx-xserver" PackageVendor="VMware" PackageVersion="5.1.0-0.0.799733" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="imgdb.tgz" DigestValue="17EF56CE8503AC7DE6F4529DCD9A5749FE6F9CD1" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="state.tgz" DigestValue="5C74843587CD5FEFFA0AE3675C64903A10037B89" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmSoftwareComponentEventDetails" ComponentName="onetime.tgz" DigestValue="1474A2F1789E7A4B429B14864F92E826D385F30B" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="False"></EventDetails><EventDetails EventName="Vim25Api.HostTpmBootSecurityOptionEventDetails" ComponentName="execInstalledOnly = FALSE" DigestValue="739AFF7705B06BA29C915E41491105672507B632" ExtendedToPCR="19" PackageName="" PackageVendor="" PackageVersion="" UseHostSpecificDigest="False"></EventDetails><PCRInfo ComponentName="0" DigestValue="891EB0B556B83FCEF1C10F3FA6464345E34F8F91"></PCRInfo><PCRInfo ComponentName="17" DigestValue="496C8530D2B4BA6A6F3901455C8C240BBB482D85"></PCRInfo><PCRInfo ComponentName="18" DigestValue="F6FD306D2FA33E21C69CA598330B64DF1ED0D002"></PCRInfo><PCRInfo ComponentName="20" DigestValue="7F824EA48E5D50A4B236152223206B00620BC74B"></PCRInfo></Host_Attestation_Report>
     * @throws Exception 
     */
    @Test
    public void testGetAttestationFromVmwareHost() throws Exception {
        TxtHostRecord host = new TxtHostRecord();
        host.HostName = "10.1.71.174";
        host.AddOn_Connection_String = "https://10.1.71.162:443/sdk;administrator;intel123!";
        VMwareClient client = new VMwareClient();
        client.connect(host.AddOn_Connection_String);
        String report = client.getHostAttestationReport(host, "0,17,18,20");
        System.out.println(report);
    }

    @Test
    public void testPropertyNamesFromVmwareHost() throws Exception {
        TxtHostRecord host = new TxtHostRecord();
        host.HostName = "10.1.71.174";
        host.AddOn_Connection_String = "https://10.1.71.162:443/sdk;administrator;intel123!";
        VMwareClient client = new VMwareClient();
        client.connect(host.AddOn_Connection_String);
        List<String> properties = client.getPropertyNames(host);
        System.out.println("Retrieved "+properties.size()+" properties");
        for(String p : properties) {
            System.out.println(p);
        }
    }
    
    @Test
    public void testSessionIsConnected() throws Exception {
        TxtHostRecord host = new TxtHostRecord();
        host.HostName = "10.1.71.174";
        host.AddOn_Connection_String = "https://10.1.71.162:443/sdk;administrator;intel123!";
        VMwareClient client = new VMwareClient();
        client.connect(host.AddOn_Connection_String);
        String report = client.getHostAttestationReport(host, "0,17,18,20");
        System.out.println(report);
        System.out.println("session is connected? "+client.isConnected());
        // you can disconnect officially:
        client.disconnect();
        // or  try it by disconnecting from your network:
        /*
        try {
            System.out.println("sleeping 5 seconds... disconnect networking now!!");
            Thread.currentThread().sleep(5000);
        }
        catch(InterruptedException e ) {
            System.out.println("interrupted...");
        }
        */
        System.out.println("(after disconnect) session is connected? "+client.isConnected());
    }
    

	/*
    @Test
    public void commonsEncoderCompatibleWithSun() {
        String sunResult = new BASE64Encoder().encode("hello world!".getBytes());
        String commonsResult = Base64.encodeBase64String("hello world!".getBytes());
        System.out.println("hello world! encoded: "+sunResult);
        assertEquals(sunResult, commonsResult);
    }

    @Test
    public void commonsDecoderCompatibleWithSun() throws IOException {
        String sunResult = new String(new BASE64Decoder().decodeBuffer("aGVsbG8gd29ybGQh"));
        String commonsResult = new String(Base64.decodeBase64("aGVsbG8gd29ybGQh"));
        System.out.println("aGVsbG8gd29ybGQh decoded: "+sunResult);
        assertEquals(sunResult, commonsResult);
    }
    */
    
    @Test
    public void testHelper() {
        try {
            System.out.println(System.getenv());

            //HashMap result = VMwareHelper.getQuoteInformationForHost("10.1.71.108", "0,20", "https://10.1.71.115:444/sdk;RAUser;Intel123!");
//            System.out.println("Result - " + result.toString());
//            HashMap result = new VMwareClient().getQuoteInformationForHost("10.1.71.141", "0,20", "https://10.1.71.142:444/sdk;Administrator;P@ssw0rd");
            
            
            //HashMap result = VMwareHelper.getQuoteInformationForHost("10.1.71.154", "0,20", "https://10.1.71.142:444/sdk;Administrator;P@ssw0rd");	
//            System.out.println("Result - " + result.toString());
              
//            ManagedObjectReference result = VMwareHelper.findChild("10.1.71.108", "0,20", "https://10.1.71.115:444/sdk;RAUser;Intel123!");
            
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
    
}
